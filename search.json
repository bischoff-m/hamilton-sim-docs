[
  {
    "objectID": "notation.html",
    "href": "notation.html",
    "title": "Preliminaries",
    "section": "",
    "text": "\\[\n\\newcommand{\\1}{1\\hspace{-0,9ex}1}\n\\newcommand{\\R}{\\mathbb{R}}\n\\newcommand{\\E}{\\mathbb{E}}\n\\newcommand{\\Prob}{\\mathbb{P}}\n\\newcommand{\\cvar}{\\text{CVaR}}\n\\newcommand{\\var}{\\text{VaR}}\n\\newcommand{\\V}{\\mathbb{V}}\n\\newcommand{\\N}{\\mathbb{N}}\n\\newcommand{\\T}{\\mathbb{T}}\n\\]\n\nDefinitions & Notations\nFor the notations and definitions used in the main chapters of this documentation, we consider state-space systems \\(\\Sigma\\) with inputs and outputs of the general form\n\\[\\begin{align*}\n\\dot{x} &= f(x,u),\\quad u\\in U\\\\\ny &= h(x, u),\\quad y\\in Y\n\\end{align*}\\]\nwhere \\(x=(x_1,\\ldots,x_n)\\) are local coordinates for an \\(n\\)-dimensional state space manifold \\(\\mathcal{X}\\subseteq\\R^n\\), and \\(U\\) and \\(Y\\) are linear spaces, of dimension \\(m\\), respectively \\(p\\). We assume that there exists a unique solution trajectory \\(x(\\cdot)\\) on \\([0,\\infty)\\) of the differential equation for all initial conditions \\(x(0)\\). On the combined space \\(U\\times Y\\) of inputs and outputs consider a function\n\\[\\begin{align*}\ns:U\\times Y\\to\\R,\n\\end{align*}\\]\ncalled supply rate.\n\n(Cyclo-)Dissipativity, conservative\nA state-space system \\(\\Sigma\\) is said to be dissipative with respect to the supply rate \\(s\\) if there exists a function \\(S:\\mathcal{X}\\to [0,\\infty)\\), called storage function, such that for all initial conditions \\(x(t_0) = x_0\\in\\mathcal{X}\\) at any time \\(t_0\\), and for all allowed input functions \\(u(\\cdot)\\) and all \\(t_1\\geq t_0\\) the following inequality holds \\[\\begin{align}\\label{eq:DissIneq}\nS(x(t_1))\\leq S(x(t_0)) + \\int_{t_0}^{t_1}s(u(t), y(t))dt.\n\\end{align}\\] If this inequality holds with equality for all \\(x_0\\), \\(t_1\\geq t_0\\), and all \\(u(\\cdot)\\), then \\(\\Sigma\\) is conservative with respect to \\(s\\). Finally, \\(\\Sigma\\) is called cyclo-dissipative with respect to \\(s\\) if there exists a function \\(S:\\mathcal{X}\\to\\R\\) (not necessarily nonnegative) such that the inequality above holds.\n\nThe inequality above is called the dissipation inequality. It expresses the fact that the stored energy \\(S(x(t_1))\\) of \\(\\Sigma\\) at any future time \\(t_1\\) is at most equal to the stored energy \\(S(x(t_0))\\) at present time \\(t_0\\), plus the total externally supplied energy\n\\[\n\\int_{t_0}^{t_1}s(u(t), y(t))dt\n\\]\nduring the time interval \\([t_0,t_1]\\).\n\nPassivity\nA state space system \\(\\Sigma\\) with \\(U=Y=\\R^m\\) is passive if it is dissipative with respect to the supply rate \\(s(u,y) = u^Ty\\). \\(\\Sigma\\) is input strictly passive if there exists \\(\\delta&gt;0\\) such that \\(\\Sigma\\) is dissipative with respect to \\(s(u,y) = u^Ty - \\delta\\|u\\|^2\\). \\(\\Sigma\\) is ouput strictly passive if there exists \\(\\varepsilon&gt;0\\) such that \\(\\Sigma\\) is dissipative with respect to \\(s(u,y) = u^Ty - \\varepsilon\\|y\\|^2\\). Finally, \\(\\Sigma\\) is lossless if it is conservative with respect to \\(s(u,y) = u^Ty\\).\n\n\n\\(L_2\\)-Gain\nA state space system \\(\\Sigma\\) with \\(U=\\R^m\\), \\(Y=\\R^p\\) has \\(L_2\\)-gain \\(\\leq\\gamma\\) if it is dissipative with respect to the supply rate \\(s(u,y) = \\frac{\\gamma^2}{2}\\|u\\|^2 - \\frac{1}{2}\\|y\\|^2\\). The \\(L_2\\)-gain of \\(\\Sigma\\) is defined as \\[\n\\gamma(\\Sigma) := \\inf\\{\\gamma\\;|\\; \\Sigma\\;\\text{has}\\;L_2-\\text{gain}\\;\\leq \\gamma\\}.\n\\]\n\\(\\Sigma\\) is said to have \\(L_2\\)-gain \\(&lt;\\gamma\\) if there exists \\(\\tilde{\\gamma}&lt;\\gamma\\) such that \\(\\Sigma\\) has \\(L_2\\)-gain \\(\\leq\\tilde{\\gamma}\\). Finally \\(\\Sigma\\) is called inner if it is conservative with respect to \\(s(u,y)= \\frac{1}{2}\\|u\\|^2 - \\frac{1}{2}\\|y\\|^2\\)."
  },
  {
    "objectID": "ControlofPHS.html",
    "href": "ControlofPHS.html",
    "title": "Control of Port-Hamiltonian Systems",
    "section": "",
    "text": "\\[\n\\newcommand{\\1}{1\\hspace{-0,9ex}1}\n\\newcommand{\\R}{\\mathbb{R}}\n\\newcommand{\\E}{\\mathbb{E}}\n\\newcommand{\\Prob}{\\mathbb{P}}\n\\newcommand{\\cvar}{\\text{CVaR}}\n\\newcommand{\\var}{\\text{VaR}}\n\\newcommand{\\V}{\\mathbb{V}}\n\\newcommand{\\N}{\\mathbb{N}}\n\\newcommand{\\T}{\\mathbb{T}}\n\\]"
  },
  {
    "objectID": "ControlofPHS.html#control-of-port-hamiltonian-systems",
    "href": "ControlofPHS.html#control-of-port-hamiltonian-systems",
    "title": "Control of Port-Hamiltonian Systems",
    "section": "Control of port-Hamiltonian systems",
    "text": "Control of port-Hamiltonian systems\nConsider an input-state-output port-Hamiltonian system \\(\\Sigma\\) without feedthrough terms. The simplest situation in stabilization is when the set-point \\(x^\\ast\\in\\mathcal{X}\\) is a strict minimum of the Hamiltonian \\(H\\). In this case, the pHS is passive, and thus we may directly apply the asymptotic stabilization theory of passive systems provided in Chapter 4 of Van der Schaft (2000), by employing output feedback \\(u=-Dy\\) with \\(D=D^T\\) a positive definite matrix, and using the Hamiltonian \\(H\\) as Lyapunov function.\n\nEnergy-Casimir method\nThe situation becomes different when the set-point \\(x^\\ast\\) is not a strict minimum of the Hamiltonian \\(H\\). A new twist is provided by the possible existence of Casimir functions. Assume one can find a Casimir function \\(C\\) such that the modified Hamiltonian\n\\[\nH_\\text{mod}(x) := \\Phi(H(x), C(x))\n\\]\nfor some map \\(\\Phi:\\R^2 \\to\\R\\) has a strict minimum at the set-point \\(x^\\ast\\). Then the system can be rewritten as the modified ISOPHS\n\\[\\begin{align*}\n\\dot{x} &= [J(x) - R(x)]\\nabla H_\\text{mod}(x) + g(x)u\\\\\ny_\\text{mod} &= g^T(x) \\nabla H_\\text{mod}(x),\n\\end{align*}\\]\nwhich is passive w.r.t. the modified output \\(y_\\text{mod}\\). Hence, asymptotic stabilization of \\(x^\\ast\\) may be achieved by feedback \\(u=Dy_\\text{mod}\\), \\(D&gt;0\\), employing \\(H_\\text{mod}\\) as Lyapunov candidate function, provided a detectability condition is satisfied. The stability analysis method of finding Casimirs \\(C_1,\\ldots, C_r\\) such that a suitable function \\(\\Phi(H,C_1,\\ldots, C_r)\\) of the energy \\(H\\) and the Casimirs has a strict minimum at the equilibrium under consideration is called the Energy-Casimir method.\n\n\nDynamic controller systems\nNext, suppose that \\(H\\) does not have a strict minimum at \\(x^\\ast\\), and that no useful Casimirs \\(C\\) can be found for direct application of the Energy-Casimir method. In this case, we will take recourse to dynamical controller systems that are also in port-Hamiltonian form, in order to generate Casimirs for the closed-loop system. Any power-conserving interconnection of pHS is again pHS. In particular, the interconnection of the plant pHS \\(\\Sigma\\) with a controller pHS \\(\\Sigma_c\\)\n\\[\\begin{align*}\n\\dot{\\xi} &= [J_c(\\xi) - R_c(\\xi)]\\nabla H_c(\\xi) + g_c(\\xi) u_c,\\quad\\xi\\in\\mathcal{X}_c, u_c\\in\\R^m\\\\\ny_c &= g_c^T(\\xi)\\nabla H_c(\\xi)\n\\end{align*}\\]\nwith \\(J_c(\\xi) = -J_c^T(\\xi)\\), \\(R_c(\\xi) = R_c^T(\\xi)\\geq 0\\), via the standard negative feedback interconnection\n\\[\\begin{align*}\nu &= -y_c + v\\\\\nu_c &= y + v_c\n\\end{align*}\\]\nwhere \\(v,v_c\\) are external input signals, results in the closed-loop system\n\\[\\begin{align*}\n\\left[\\begin{matrix}\n\\dot{x}\\\\\n\\dot{\\xi}\n\\end{matrix}\\right] &= \\left(\\underbrace{\\left[\\begin{matrix}\nJ(x) & -g(x)g_c^T(\\xi)\\\\\ng_c(\\xi)g^T(x) & J_c(\\xi)\n\\end{matrix}\\right]}_{J_{cl}(x,\\xi)} - \\underbrace{\\left[\\begin{matrix}\nR(x) & 0\\\\\n0 & R_c(\\xi)\n\\end{matrix}\\right]}_{R_{cl}(x,\\xi)}\\right)\\left[\\begin{matrix}\n\\frac{\\partial H}{\\partial x}(x) \\\\\n\\frac{\\partial H_c}{\\partial\\xi}(\\xi)\n\\end{matrix}\\right] + \\left[\\begin{matrix}\ng(x) & 0\\\\\n0 & g_c(\\xi)\n\\end{matrix}\\right]\\left[\\begin{matrix}\nv\\\\\nv_c\n\\end{matrix}\\right]\\\\\n\\left[\\begin{matrix}\ny\\\\\ny_c\n\\end{matrix}\\right] &= \\left[\\begin{matrix}\ng^T(x) & 0\\\\\n0 & g^T_c(\\xi)\n\\end{matrix}\\right]\\left[\\begin{matrix}\n\\frac{\\partial H}{\\partial x}(x) \\\\\n\\frac{\\partial H_c}{\\partial\\xi}(\\xi)\n\\end{matrix}\\right].\n\\end{align*}\\]\nThis is again an ISOPHS, with state space \\(\\mathcal{X}\\times\\mathcal{X}_c\\), Hamiltonian \\(H(x) + H_c(x)\\), interconnection structure matrix \\(J_{cl}(x, \\xi)\\), resistive structure matrix \\(R_{cl}(x,\\xi)\\), inputs \\((v,v_c)\\) and outputs \\((y,y_c)\\).\n\n\nExample: PID controllers\nConsider the standard Proportional-Integral-Derivative (PID) controller\n\\[\ny_c = k_Pu_c + k_I \\int u_c dt + k_D\\dot{u}_c\n\\]\nfor certain positive constants \\(k_P, k_I, k_D\\). Rewriting the above as\n\\[\nk_D\\dot{u}_c = -k_Pu_c - k_I\\int u_cdt + y_c\n\\]\nand defining \\(\\xi = \\int u_cdt\\) (or equivalently \\(\\dot{\\xi} = u_c\\)) and \\(\\eta=k_Du_c\\), the PID-controller can be formulated as the linear ISOPHS\n\\[\\begin{align*}\n\\left[\\begin{matrix}\n\\dot{\\xi}\\\\\n\\dot{\\eta}\n\\end{matrix}\\right] &= \\left[\\begin{matrix}\n0 & 1\\\\\n-1 & -k_P\n\\end{matrix}\\right]\\left[\\begin{matrix}\nk_I\\xi\\\\\n\\frac{\\eta}{k_D}\n\\end{matrix}\\right] + \\left[\\begin{matrix}\n0\\\\\n1\n\\end{matrix}\\right]y_c\\\\\nu_c &= \\left[\\begin{matrix}\n0 & 1\n\\end{matrix}\\right]\\left[\\begin{matrix}\nk_I\\xi\\\\\n\\frac{\\eta}{k_D}\n\\end{matrix}\\right]\n\\end{align*}\\]\nwith Hamiltonian \\(H_c(\\xi,\\eta) = \\frac{1}{2}k_I\\xi^2 + \\frac{1}{2k_D}\\eta^2\\). Considering any plant ISOPHS \\(\\Sigma\\), the closed-loop system arising from standard feedback \\(u=-y_c\\), \\(u_c = y\\) with the PID controller is given by the pHDAE\n\\[\\begin{align*}\n\\dot{x} &= [J(x) - R(x)]\\nabla H(x) + g(x)u\\\\\n\\left[\\begin{matrix}\n\\dot{\\xi}\\\\\n\\dot{\\eta}\n\\end{matrix}\\right] &= \\left[\\begin{matrix}\n0 & 1\\\\\n-1 & -k_P\n\\end{matrix}\\right]\\left[\\begin{matrix}\nk_I\\xi\\\\\n\\frac{\\eta}{k_D}\n\\end{matrix}\\right] - \\left[\\begin{matrix}\n0\\\\\n1\n\\end{matrix}\\right]u\\\\\n0 &= g^T(x)\\nabla H(x) - \\left[\\begin{matrix}\n0 & 1\n\\end{matrix}\\right]\\left[\\begin{matrix}\nk_I\\xi\\\\\n\\frac{\\eta}{k_D}\n\\end{matrix}\\right]\n\\end{align*}\\]\n\n\nControl by Energy-routing\nConsider the problem of energy-transfer. Consider two pHS \\(\\Sigma_i\\) (without internal dissipation) in input-state-output form\n\\[\\begin{align*}\n\\dot{x}_i &= J_i(x_i)\\frac{\\partial H_i}{\\partial x_i}(x_i) + g_i(x_i)u_i,\\quad u_i\\in\\R^m,\\\\\ny_i &= g_i^T(x_i) \\frac{\\partial H_i}{\\partial x_i}(x_i),\n\\end{align*}\\]\n\\(i=1,2\\) both satisfying the power balance\n\\[\n\\dot{H}_i(x_i) = y_i^Tu_i.\n\\]\nSuppose now that we want to transfer energy from system \\(\\Sigma_1\\) to \\(\\Sigma_2\\), while keeping the total energy \\(H_1+H_2\\) constant. This can be done by using the following output feedback\n\\[\\begin{align*}\n\\left[\\begin{matrix}\nu_1\\\\\nu_2\n\\end{matrix}\\right] &= \\left[\\begin{matrix}\n0 & -y_1y_2^T\\\\\ny_2y_1 & 0\n\\end{matrix}\\right]\\left[\\begin{matrix}\ny_1\\\\\ny_2\n\\end{matrix}\\right]\n\\end{align*}\\]\nwhich due to its skew-symmetry property, is power preserving. Hence, the closed-loop system composed of \\(\\Sigma_1\\) and \\(\\Sigma_2\\) is energy preservingm that is \\(\\dot{H}_1 + \\dot{H}_2 = 0\\). However, if we consider the individual energies then we notice that \\[\\begin{align*}\n\\dot{H}_1(x) = -y_1^Ty_1y_2^Ty_2 = -\\|y_1\\|^2\\|y_2\\|^2\\geq 0,\n\\end{align*}\\] implying that \\(H_1\\) is decreasing as long as \\(\\|y_1\\|\\) and \\(\\|y_2\\|\\) are different from \\(0\\). Conversely, as expected since the total energy is constant,\n\\[\\begin{align*}\n\\dot{H}_2(x) = y_2^Ty_2y_1^Ty_1 = \\|y_2\\|^2\\|y_1\\|^2\\leq 0,\n\\end{align*}\\]\nimplying that \\(H_2\\) is increasing at the same rate. In particular, if \\(H_1\\) has a minimum at the zero equilibrium, and \\(\\Sigma_1\\) is zero-state detectable, then all the energy \\(H_1\\) of \\(\\Sigma_1\\) will be transferred to \\(\\Sigma_2\\), as long as \\(\\|y_2\\|\\) is not zero. If there is internal energy dissipation in \\(\\Sigma_1\\) and/or \\(\\Sigma_2\\), then this energy transfer mechanism still works. However, the fact that \\(H_2\\) grows or not will depend on the balance between the energy delivered by \\(\\Sigma_1\\) to \\(\\Sigma_2\\) and the internal loss of energy in \\(\\Sigma_2\\) due to dissipation. We conclude that this particular scheme of power-conserving energy transfer is accomplished by a skew-symmetric output feedback, which is modulated by the values of the output vectors of both systems. A related scenario for energy-routing is the case where the interconnection matrix \\(J\\) is depending on the control \\(u\\). Such a case, for example, occurs in the control of power converters, where different switch positions lead to different circuit topologies, and where the duty ratio’s may be taken as control variables, leading to \\(J(u)\\). Especially in case external sources and sinks are present, this allows for a control of the power flow through the system in such a manner that certain crucial variables are kept close to their desired values."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Home",
    "section": "",
    "text": "This is a knowledge base and the documentation for hamilton-sim, a Julia package for simulating port-Hamiltonian systems."
  },
  {
    "objectID": "index.html#welcome",
    "href": "index.html#welcome",
    "title": "Home",
    "section": "",
    "text": "This is a knowledge base and the documentation for hamilton-sim, a Julia package for simulating port-Hamiltonian systems."
  },
  {
    "objectID": "index.html#getting-started",
    "href": "index.html#getting-started",
    "title": "Home",
    "section": "Getting Started",
    "text": "Getting Started\n\nPrerequisites\nTo work with this repository, you’ll need:\n\nQuarto - Download and install from https://quarto.org/docs/get-started/\n\nChoose the installer for your operating system\nVerify installation: quarto --version\n\nJulia (Optional) - Required only if you want to execute Julia code blocks\n\nDownload from https://julialang.org/downloads/\nVerify installation: julia --version\n\n\n\n\nSetup\nClone this repository:\ngit clone git@github.com:bischoff-m/hamilton-sim-docs.git\ncd hamilton-sim-docs\nQuarto will automatically install any required Julia packages when rendering documents. Use the Julia REPL to add new packages as needed.\n\n\nPreview\nTo preview the documentation locally:\n# Start the preview server\nquarto preview docs\n\n# Or preview without watching for file changes\nquarto preview docs --no-watch-inputs\n\n# Or preview without opening a browser\nquarto preview docs --no-browser\nThe preview server will start and display the local URL.\n\n\nBuild\nTo build static HTML files:\ncd docs\nquarto render\nThe generated site will be in the docs/_site directory."
  },
  {
    "objectID": "LinearPHS.html",
    "href": "LinearPHS.html",
    "title": "Port-Hamiltonian Systems",
    "section": "",
    "text": "\\[\n\\newcommand{\\1}{1\\hspace{-0,9ex}1}\n\\newcommand{\\R}{\\mathbb{R}}\n\\newcommand{\\E}{\\mathbb{E}}\n\\newcommand{\\Prob}{\\mathbb{P}}\n\\newcommand{\\cvar}{\\text{CVaR}}\n\\newcommand{\\var}{\\text{VaR}}\n\\newcommand{\\V}{\\mathbb{V}}\n\\newcommand{\\N}{\\mathbb{N}}\n\\newcommand{\\T}{\\mathbb{T}}\n\\]"
  },
  {
    "objectID": "LinearPHS.html#general-port-hamiltonian-systems",
    "href": "LinearPHS.html#general-port-hamiltonian-systems",
    "title": "Port-Hamiltonian Systems",
    "section": "General port-Hamiltonian systems",
    "text": "General port-Hamiltonian systems\nThe Hamiltonian (or total energy of the system) of a general port-Hamiltonian system is a continuously differentiable function \\(H:\\mathcal{X}\\to\\R\\), for some domain \\(\\mathcal{X}\\subseteq \\R^n\\). The Hamiltonian flow of energy is described by the gradient of the Hamiltonian \\(H\\), i.e. \\[\\begin{align*}\n\\frac{\\partial H}{\\partial x}(x) = \\nabla H(x) = \\left[\\begin{matrix}\n\\frac{\\partial H}{\\partial x_1}\\\\\n\\vdots\\\\\n\\frac{\\partial H}{\\partial x_n}\n\\end{matrix}\\right].\n\\end{align*}\\]\nBy definition, port-Hamiltonian systems are (cyclo-)passive as a consequence of their system formulation. First, we define an input-state-output port-Hamiltonian system following Definition 6.1.1 in Van der Schaft (2000).\n\nDefinition: Input-state-output port-Hamiltonian system\nAn input-state-output port-Hamiltonian system (ISOPHS) with \\(n\\)-dimensional state space manifold \\(\\mathcal{X}\\), input and output spaces \\(U=Y=\\R^m\\), and Hamiltonian \\(H:\\mathcal{X}\\to\\R\\), is given by \\[\\begin{align*}\n\\dot{x} &= [J(x) - R(x)]\\nabla H(x) + g(x)u\\\\\ny &= g^T(x) \\nabla H(x)\n\\end{align*}\\] where the \\(n\\times n\\)-matrices \\(J(x), R(x)\\) satisfy \\(J(x) = -J^T(x)\\) and \\(R(x) = R^T(x)\\geq 0\\).\n\nBy the properties of \\(J(x)\\) and \\(R(x)\\), it immediately follows that\n\\[\\begin{align*}\n\\frac{d H}{dt}(x(t)) &= \\frac{\\partial^T H}{\\partial x}(x(t))\\dot{x}(t) = -\\frac{\\partial^T H}{\\partial x}(x(t))R(x(t))\\frac{\\partial H}{\\partial x}(x(t)) + y^T(t)u(t) \\leq u^T(t)y(t),\n\\end{align*}\\]\nimplying cyclo-passivity and passivity if \\(H\\geq 0\\). An input-state-output pHS with non-linear resistive structure is given as\n\\[\\begin{align*}\n\\dot{x} &= J(x)z - R(x, z) + g(x)u,\\quad z = \\nabla H(x),\\\\\ny &= g^T(x) z\n\\end{align*}\\]\nwhere \\(J(x) = -J^T(x)\\), and the resistive mapping \\(R(x,\\cdot):\\R^n\\to\\R^n\\) satisfies\n\\[\nz^TR(x,z)\\geq 0,\\quad\\text{for all}\\; z\\in\\R^n,\\;x\\in\\mathcal{X}.\n\\]\n\nDefinition: pHS with feedthrough\nAn input-state-output port-Hamiltonian system with feedthrough terms is specified by an \\(n\\)-dimensional state space manifold \\(\\mathcal{X}\\), input and output spaces \\(U=Y=\\R^m\\), Hamiltonian \\(H:\\mathcal{X}\\to\\R\\), and dynamics \\[\\begin{align*}\n\\dot{x} &= [J(x) - R(x)]\\nabla H(x) + [G(x) - P(x)]u,\\\\\ny &= [G(x) - P(x)]^T\\nabla H(x) + [M(x) + S(x)]u,\n\\end{align*}\\] where the matrices \\(J(x), M(x), R(x), P(x), S(x)\\) satisfy the skew-symmetry conditions \\(J(x) = -J^T(x)\\), \\(M(x) = -M^T(x)\\), and the nonnegativity condition\n\\[\\begin{align*}\n\\left[\\begin{matrix}\nR(x) & P(x) \\\\\nP^T(x) & S(x)\n\\end{matrix}\\right]\\geq 0,\\quad x\\in\\mathcal{X}.\n\\end{align*}\\]"
  },
  {
    "objectID": "LinearPHS.html#properties-of-port-hamiltonian-systems",
    "href": "LinearPHS.html#properties-of-port-hamiltonian-systems",
    "title": "Port-Hamiltonian Systems",
    "section": "Properties of port-Hamiltonian systems",
    "text": "Properties of port-Hamiltonian systems\n\nDefinition: Casimir functions\nA Casimir function for an input-state-output port-Hamiltonian system is any function \\(C:\\mathcal{X}\\to\\R\\) satisfying\n\\[\n\\frac{\\partial^TC}{\\partial x}(x)[J(x) - R(x)] = 0,\\quad x\\in\\mathcal{X}.\n\\]\n\nA Casimir is a conserved quantity of the system for \\(u=0\\), independently of the Hamiltonian \\(H\\). In many cases of interest, the desired setpoint of a pHS is not equal to the minimum of the Hamiltonian function \\(H\\), but instead is a steady-state value corresponding to a nonzero constant input. This motivates the following Proposition by Van der Schaft (2000) and terminology of shifted passivity.\n\nShifted passivity\nConsider an input-state-output pHS with feedthrough terms, together with a constant input \\(\\bar{u}\\) with corresponding steady-state \\(\\bar{x}\\) determined by \\[\n0 = [J(\\bar{x}) - R(\\bar{x})]\\nabla H(\\bar{x}) + [G(\\bar{x}) - P(\\bar{x})]\\bar{u}.\n\\] Denote \\[\n\\bar{y} = [G(\\bar{x})+P(\\bar{x})]^T\\nabla H(\\bar{x}) + [M(\\bar{x}) + S(\\bar{x})]\\bar{u}.\n\\] Suppose we can find coordinates \\(x\\) in which the system matrices \\(J(x), M(x), R(x), P(x), S(x), G(x)\\) are all constant. Then the system can be rewritten as \\[\\begin{align*}\n\\dot{x} &= [J-R]\\nabla \\hat{H}_{\\bar{x}}(x) + [G - P](u-\\bar{u})\\\\\ny - \\bar{y} &= [G + P]^T\\nabla\\hat{H}_{\\bar{x}}(x) + [M+S](u-\\bar{u})\n\\end{align*}\\] with respect to the shifted Hamiltonian defined as \\[\n\\hat{H}_{\\bar{x}}(x) := H(x) - \\nabla^T H(\\bar{x})(x-\\bar{x}) - H(\\bar{x}).\n\\] If \\(H\\) is convex in the coordinates \\(x\\), then \\(\\hat{H}_{\\bar{x}}\\) has a minimum at \\(x=\\bar{x}\\) (with value \\(0\\)), and the pHS is passive with respect to the shifted supply rate \\(s(u,y) = (u- \\bar{u})^T(y - \\bar{y})\\), with storage function \\(\\hat{H}_{\\bar{x}}\\)."
  },
  {
    "objectID": "LinearPHS.html#linear-port-hamiltonian-systems",
    "href": "LinearPHS.html#linear-port-hamiltonian-systems",
    "title": "Port-Hamiltonian Systems",
    "section": "Linear port-Hamiltonian systems",
    "text": "Linear port-Hamiltonian systems\nLinear port-Hamiltonian systems arise when the underlying Hamiltonian (or total energy of the system) is a quadratic function in the state, i.e. \\[\\begin{align*}\nH(x) = \\frac{1}{2}x^TQx.\n\\end{align*}\\] for some state \\(x\\in\\R^n\\) with entries \\(x_i\\), \\(i=1,\\ldots, n\\) and square matrix \\(Q\\in\\R^{n\\times n}\\).\n\nDefinition: port-Hamiltonian system\nConsider a time interval \\(\\mathbb{T}:=[0,T]\\subset\\mathbb{R}\\), \\(T&gt;0\\), a state space \\(\\mathcal{X}\\subseteq\\R^n\\) and extended state space \\(\\mathcal{S}:=\\T\\times\\mathcal{X}\\). A port-Hamiltonian system (or pHS) is a system of ordinary differential equations of the form \\[\\begin{align*}\n            \\dot{x} &= (J-R)\\nabla H(x) + Gu + Kd,\\\\\n            y &= G^T\\nabla H(x),\\\\\n            z &= K^T\\nabla H(x),\n        \\end{align*}\\] with a Hamiltonian function \\(\\mathcal{H}(x):\\mathcal{X}\\to\\R\\), where \\(x(t)\\in\\mathcal{X}\\) is the state, \\(u(t)\\in\\R^{m_1}, y(t)\\in\\R^{m_1}\\), are the controllable input and output, \\(d(t)\\in\\R^{m_2}, z(t)\\in\\R^{m_2}\\) are the uncontrollable interaction ports. Furthermore, \\(E\\in\\R^{\\ell\\times n}\\) TODO"
  },
  {
    "objectID": "basics.html",
    "href": "basics.html",
    "title": "Basics",
    "section": "",
    "text": "Linear form: \\[\n\\dot{x} = Ax\n\\] where \\(A\\) is the state space matrix(?) and \\(x \\in \\mathbb{R}^{n}\\) always depends on time. In port-Hamiltonian systems: \\[\n\\dot{x} = (J - R)Qx\n\\] where \\(J \\in \\mathbb{R}^{n \\times n}\\) is the interconnection matrix, \\(R \\in \\mathbb{R}^{n \\times n}\\) the dissipation matrix and \\(Q \\in \\mathbb{R}^{n \\times m}\\) the linear part of the state. The more general non-linear description is \\[\n\\dot{x} = (J(x) - R(x)) \\frac{dH(x)}{dx}\n\\] where \\(\\nabla H(x) = \\frac{dH}{dx}(x)\\). For now, we keep \\(J\\) independent from \\(x\\). For specific systems it holds that \\[\nH(x) = \\frac{1}{2} x^T Q x\n\\]\nWe are interested in description of dynamics, where we can influence the output. We then use the form \\[\n\\dot{x} = Ax + Bu\n\\] where \\(B\\) is the input matrix. In port-Hamiltonian systems this translates to \\[\n\\dot{x} = (J - R)Qx + Bu\n\\] \\[\ny = B^T Qx\n\\] where \\(u\\) is the input into and \\(y\\) is the output of the system. For now we are only interested in the state \\(x\\), but not the output. Later the output of one system will be the input of another system."
  },
  {
    "objectID": "basics.html#port-hamiltonian-systems",
    "href": "basics.html#port-hamiltonian-systems",
    "title": "Basics",
    "section": "",
    "text": "Linear form: \\[\n\\dot{x} = Ax\n\\] where \\(A\\) is the state space matrix(?) and \\(x \\in \\mathbb{R}^{n}\\) always depends on time. In port-Hamiltonian systems: \\[\n\\dot{x} = (J - R)Qx\n\\] where \\(J \\in \\mathbb{R}^{n \\times n}\\) is the interconnection matrix, \\(R \\in \\mathbb{R}^{n \\times n}\\) the dissipation matrix and \\(Q \\in \\mathbb{R}^{n \\times m}\\) the linear part of the state. The more general non-linear description is \\[\n\\dot{x} = (J(x) - R(x)) \\frac{dH(x)}{dx}\n\\] where \\(\\nabla H(x) = \\frac{dH}{dx}(x)\\). For now, we keep \\(J\\) independent from \\(x\\). For specific systems it holds that \\[\nH(x) = \\frac{1}{2} x^T Q x\n\\]\nWe are interested in description of dynamics, where we can influence the output. We then use the form \\[\n\\dot{x} = Ax + Bu\n\\] where \\(B\\) is the input matrix. In port-Hamiltonian systems this translates to \\[\n\\dot{x} = (J - R)Qx + Bu\n\\] \\[\ny = B^T Qx\n\\] where \\(u\\) is the input into and \\(y\\) is the output of the system. For now we are only interested in the state \\(x\\), but not the output. Later the output of one system will be the input of another system."
  },
  {
    "objectID": "basics.html#passivity",
    "href": "basics.html#passivity",
    "title": "Basics",
    "section": "Passivity",
    "text": "Passivity\nA passive system may consume and store energy, but is incapable of producing energy.\nExact definition: Celledoni, E., & Høiseth, E. H. (2017). Energy-Preserving and Passivity-Consistent Numerical Discretization of Port-Hamiltonian Systems (No. arXiv:1706.08621). arXiv. https://doi.org/10.48550/arXiv.1706.08621"
  },
  {
    "objectID": "basics.html#references",
    "href": "basics.html#references",
    "title": "Basics",
    "section": "References",
    "text": "References\n\nA Framework for Decentralized Stabilization in Networked Energy Systems: A Passivity-Based Approach\n\nPage 82 for an example\nDefinition 3.5 (page 40) for a linear pH system\nDefinition A.2 (page 176) for dimensions"
  }
]